<!DOCTYPE html><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css" integrity="sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ" crossorigin="anonymous"><script type="module">const e=document.getElementById("link-menu-button"),n=document.getElementById("link-menu"),i=document.getElementById("open-indicator");e.addEventListener("click",()=>{n.classList.contains("opacity-0")?(n.classList.remove("pointer-events-none"),n.classList.remove("opacity-0"),i.innerText="-"):(n.classList.add("pointer-events-none"),n.classList.add("opacity-0"),i.innerText="+")});document.addEventListener("click",t=>{const s=t.target===e||e.contains(t.target),c=t.target===n||n.contains(t.target);!s&&!c&&(n.classList.add("pointer-events-none"),n.classList.add("opacity-0"),i.innerText="+")});</script> <html lang="en"> <head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><meta name="generator" content="Astro v5.0.0"><title>Machine Learning</title><meta name="description" content="This Machine Learning module provides a practical, hands-on introduction to machine learning concepts, algorithms, and frameworks, emphasizing real-world data analytics, systematic implementation, and the ethical, professional, and collaborative aspects of deploying machine learning solutions."><meta property="og:title" content="Machine Learning"><meta property="og:description" content="This Machine Learning module provides a practical, hands-on introduction to machine learning concepts, algorithms, and frameworks, emphasizing real-world data analytics, systematic implementation, and the ethical, professional, and collaborative aspects of deploying machine learning solutions."><meta property="og:image" content><link rel="stylesheet" href="/MSc-Artificial-Intelligence-Portfolio/_astro/about.DRX1v_oO.css">
<style>@import"https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap";html{font-family:Inter,sans-serif;background:#000}*{margin:0;padding:0;box-sizing:border-box;-webkit-font-smoothing:antialiased;color:#fff}code{font-family:Menlo,Monaco,Lucida Console,Liberation Mono,DejaVu Sans Mono,Bitstream Vera Sans Mono,Courier New,monospace}.hover-underline{-webkit-text-decoration:underline 1px rgba(0,0,0,0);text-decoration:underline 1px rgba(0,0,0,0);text-underline-offset:5px;transition:text-decoration-color .3s}.post:hover .hover-underline{text-decoration-color:#fff}
[data-astro-image]{width:100%;height:auto;-o-object-fit:var(--fit);object-fit:var(--fit);-o-object-position:var(--pos);object-position:var(--pos);aspect-ratio:var(--w) / var(--h)}[data-astro-image=responsive]{max-width:calc(var(--w) * 1px);max-height:calc(var(--h) * 1px)}[data-astro-image=fixed]{width:calc(var(--w) * 1px);height:calc(var(--h) * 1px)}
</style></head> <body> <header> <div class="px-6 py-6 max-w-2xl mx-auto flex items-center justify-between"> <a href="/MSc-Artificial-Intelligence-Portfolio/" class="justify-content: center"> <img src="/MSc-Artificial-Intelligence-Portfolio/logo.jpeg" alt="logo" class="rounded-full" width="50" height="50" loading="lazy" decoding="async" class="rounded-full"> </a> <nav class="ml-auto mr-6 sm:m-0 flex justify-content: center"> <ul class="hidden sm:flex sm:items-center sm:gap-2"> <li> <a class="group px-4 py-2 rounded-lg hover:bg-gray-bg opacity-60 hover:opacity-100 transition-all" href="/MSc-Artificial-Intelligence-Portfolio/" target="_self"> Home </a> </li><li> <a class="group px-4 py-2 rounded-lg hover:bg-gray-bg opacity-60 hover:opacity-100 transition-all" href="/MSc-Artificial-Intelligence-Portfolio/about" target="_self"> About </a> </li><li> <a class="group px-4 py-2 rounded-lg hover:bg-gray-bg opacity-60 hover:opacity-100 transition-all" href="/MSc-Artificial-Intelligence-Portfolio/modules" target="_self"> Master&#39;s Modules </a> </li> </ul> <div class="relative sm:hidden"> <button id="link-menu-button" class="relative font-medium opacity-60 p-4">Menu <span id="open-indicator">+</span></button> <div id="link-menu" class="absolute p-2 right-0 bg-gray-bg rounded-lg w-44 transition-opacity ease-in-out duration-300 opacity-0 z-40"> <ul> <li> <a class="block pl-4 py-3" href="/MSc-Artificial-Intelligence-Portfolio/" target="_self"> Home </a> </li><li> <a class="block pl-4 py-3" href="/MSc-Artificial-Intelligence-Portfolio/about" target="_self"> About </a> </li><li> <a class="block pl-4 py-3" href="/MSc-Artificial-Intelligence-Portfolio/modules" target="_self"> Master&#39;s Modules </a> </li> </ul> </div> </div> </nav> <div> <a href="mailto:disnil7@gmail.com" class="block p-2 opacity-60 hover:opacity-100 transition-opacity" aria-label="Email"> <svg width="20" height="20" data-icon="mdi:email">   <symbol id="ai:mdi:email" viewBox="0 0 24 24"><path fill="currentColor" d="m20 8l-8 5l-8-5V6l8 5l8-5m0-2H4c-1.11 0-2 .89-2 2v12a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2"/></symbol><use href="#ai:mdi:email"></use>  </svg> </a> </div> </div> </header> <main class="mb-32 max-w-4xl mx-auto px-8"> <section class="mt-10 mx-auto px-6"><h1 class="font-bold text-3xl mb-1">Neural Network Model for Object Recognition Using CIFAR-10</h1><p class="text-sm font-semibold text-xl mt-4 text-gray-400">Unit 11.2</p><div class="mt-6 prose prose-invert" style="text-align:justify"><h2 id="objective">Objective</h2>
<p>In this project, we aimed to design a neural network model for object recognition using the CIFAR-10 dataset. Object recognition is a critical task in many fields, such as autonomous vehicles, where accurate identification of objects can significantly enhance decision-making processes. The primary goal of this project is to develop a model that can correctly classify images from the CIFAR-10 dataset, which contains 60,000 color images across 10 distinct classes. These classes include categories like airplanes, automobiles, birds, cats, dogs, and more. The challenge is to design a neural network model that can generalize and correctly identify these objects from the images.</p>
<h2 id="data-preprocessing">Data Preprocessing</h2>
<p>To begin with, we load the CIFAR-10 dataset, which is divided into a training set, a validation set, and a test set. We split the training data into 80% for training and 20% for validation. Then, we normalize the pixel values and one-hot encode the target labels.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0" data-language="python"><code><span class="line"><span style="color:#6A737D"># Loading the CIFAR-10 dataset</span></span>
<span class="line"><span style="color:#E1E4E8">(x_train, y_train), (x_test, y_test) </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> cifar10.load_data()</span></span>
<span class="line"><span style="color:#79B8FF">print</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">&quot;====== CIFAR10 (Original Split) ======&quot;</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#79B8FF">print</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">&#39;x_train shape:&#39;</span><span style="color:#E1E4E8">, x_train.shape)</span></span>
<span class="line"><span style="color:#79B8FF">print</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">&#39;y_train shape:&#39;</span><span style="color:#E1E4E8">, y_train.shape)</span></span>
<span class="line"><span style="color:#79B8FF">print</span><span style="color:#E1E4E8">(x_train.shape[</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">], </span><span style="color:#9ECBFF">&#39;train samples&#39;</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#79B8FF">print</span><span style="color:#E1E4E8">(x_test.shape[</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">], </span><span style="color:#9ECBFF">&#39;test samples&#39;</span><span style="color:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D"># Splitting training data into training and validation sets</span></span>
<span class="line"><span style="color:#E1E4E8">x_train, x_val, y_train, y_val </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> train_test_split(x_train, y_train, </span><span style="color:#FFAB70">test_size</span><span style="color:#F97583">=</span><span style="color:#79B8FF">0.2</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">random_state</span><span style="color:#F97583">=</span><span style="color:#79B8FF">42</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">stratify</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">y_train)</span></span>
<span class="line"><span style="color:#79B8FF">print</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">&quot;====== CIFAR10 (With Validation Split) ======&quot;</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#79B8FF">print</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">&#39;x_train shape:&#39;</span><span style="color:#E1E4E8">, x_train.shape)</span></span>
<span class="line"><span style="color:#79B8FF">print</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">&#39;y_train shape:&#39;</span><span style="color:#E1E4E8">, y_train.shape)</span></span>
<span class="line"><span style="color:#79B8FF">print</span><span style="color:#E1E4E8">(x_train.shape[</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">], </span><span style="color:#9ECBFF">&#39;train samples&#39;</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#79B8FF">print</span><span style="color:#E1E4E8">(x_val.shape[</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">], </span><span style="color:#9ECBFF">&#39;val samples&#39;</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#79B8FF">print</span><span style="color:#E1E4E8">(x_test.shape[</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">], </span><span style="color:#9ECBFF">&#39;test samples&#39;</span><span style="color:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D"># Normalizing pixel values from integers (0, 255) to floats (0, 1)</span></span>
<span class="line"><span style="color:#E1E4E8">x_train </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> x_train.astype(</span><span style="color:#9ECBFF">&#39;float32&#39;</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">/</span><span style="color:#79B8FF"> 255</span></span>
<span class="line"><span style="color:#E1E4E8">x_val </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> x_val.astype(</span><span style="color:#9ECBFF">&#39;float32&#39;</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">/</span><span style="color:#79B8FF"> 255</span></span>
<span class="line"><span style="color:#E1E4E8">x_test </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> x_test.astype(</span><span style="color:#9ECBFF">&#39;float32&#39;</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">/</span><span style="color:#79B8FF"> 255</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D"># One-hot encoding target variables</span></span>
<span class="line"><span style="color:#E1E4E8">y_train </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> utils.to_categorical(y_train, </span><span style="color:#79B8FF">CLASS_COUNT</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">y_val </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> utils.to_categorical(y_val, </span><span style="color:#79B8FF">CLASS_COUNT</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">y_test </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> utils.to_categorical(y_test, </span><span style="color:#79B8FF">CLASS_COUNT</span><span style="color:#E1E4E8">)</span></span></code></pre>
<h2 id="data-distribution">Data Distribution</h2>
<p>The dataset is balanced, meaning that each class has an equal number of images, which helps prevent bias toward one class over another. Below is the distribution of images across the training, validation, and test sets.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0" data-language="python"><code><span class="line"><span style="color:#6A737D"># Visualizing the class distribution across training, validation, and test sets</span></span>
<span class="line"><span style="color:#E1E4E8">class_counts_train </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> np.bincount(y_train.flatten())</span></span>
<span class="line"><span style="color:#E1E4E8">class_counts_val </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> np.bincount(y_val.flatten())</span></span>
<span class="line"><span style="color:#E1E4E8">class_counts_test </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> np.bincount(y_test.flatten())</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">fig, axes </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> plt.subplots(</span><span style="color:#79B8FF">1</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">3</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">figsize</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">15</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">5</span><span style="color:#E1E4E8">))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D"># Training Class Distribution</span></span>
<span class="line"><span style="color:#E1E4E8">axes[</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">].bar(</span><span style="color:#79B8FF">CLASS_NAMES</span><span style="color:#E1E4E8">, class_counts_train, </span><span style="color:#FFAB70">color</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">colors, </span><span style="color:#FFAB70">edgecolor</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">&#39;black&#39;</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">axes[</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">].set_title(</span><span style="color:#9ECBFF">&#39;Training Set&#39;</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">axes[</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">].set_ylabel(</span><span style="color:#9ECBFF">&#39;Number of Images&#39;</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">axes[</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">].tick_params(</span><span style="color:#FFAB70">axis</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">&#39;x&#39;</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">rotation</span><span style="color:#F97583">=</span><span style="color:#79B8FF">45</span><span style="color:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D"># Validation Class Distribution</span></span>
<span class="line"><span style="color:#E1E4E8">axes[</span><span style="color:#79B8FF">1</span><span style="color:#E1E4E8">].bar(</span><span style="color:#79B8FF">CLASS_NAMES</span><span style="color:#E1E4E8">, class_counts_val, </span><span style="color:#FFAB70">color</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">colors, </span><span style="color:#FFAB70">edgecolor</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">&#39;black&#39;</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">axes[</span><span style="color:#79B8FF">1</span><span style="color:#E1E4E8">].set_title(</span><span style="color:#9ECBFF">&#39;Validation Set&#39;</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">axes[</span><span style="color:#79B8FF">1</span><span style="color:#E1E4E8">].set_xlabel(</span><span style="color:#9ECBFF">&#39;Class&#39;</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">axes[</span><span style="color:#79B8FF">1</span><span style="color:#E1E4E8">].tick_params(</span><span style="color:#FFAB70">axis</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">&#39;x&#39;</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">rotation</span><span style="color:#F97583">=</span><span style="color:#79B8FF">45</span><span style="color:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D"># Testing Class Distribution</span></span>
<span class="line"><span style="color:#E1E4E8">axes[</span><span style="color:#79B8FF">2</span><span style="color:#E1E4E8">].bar(</span><span style="color:#79B8FF">CLASS_NAMES</span><span style="color:#E1E4E8">, class_counts_test, </span><span style="color:#FFAB70">color</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">colors, </span><span style="color:#FFAB70">edgecolor</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">&#39;black&#39;</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">axes[</span><span style="color:#79B8FF">2</span><span style="color:#E1E4E8">].set_title(</span><span style="color:#9ECBFF">&#39;Test Set&#39;</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">axes[</span><span style="color:#79B8FF">2</span><span style="color:#E1E4E8">].tick_params(</span><span style="color:#FFAB70">axis</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">&#39;x&#39;</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">rotation</span><span style="color:#F97583">=</span><span style="color:#79B8FF">45</span><span style="color:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">fig.suptitle(</span><span style="color:#9ECBFF">&#39;Class Distribution in CIFAR-10 across sets&#39;</span><span style="color:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">plt.tight_layout(</span><span style="color:#FFAB70">rect</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">[</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">0.03</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">1</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">0.95</span><span style="color:#E1E4E8">])</span></span>
<span class="line"><span style="color:#E1E4E8">plt.show()</span></span></code></pre>
<h2 id="model-architecture">Model Architecture</h2>
<p>For this project, we utilize a Convolutional Neural Network (CNN), which is well-suited for image classification tasks. The architecture consists of two convolutional blocks followed by a classification block. The convolutional layers apply filters to detect local patterns in the image, such as edges and textures, while the dense layers help in making the final classification based on the learned features.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0" data-language="python"><code><span class="line"><span style="color:#6A737D"># Building the model</span></span>
<span class="line"><span style="color:#E1E4E8">model </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> Sequential(</span><span style="color:#FFAB70">name</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">&quot;CIFAR10_CNN_v1&quot;</span><span style="color:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D"># First convolutional block</span></span>
<span class="line"><span style="color:#E1E4E8">model.add(Conv2D(</span><span style="color:#79B8FF">32</span><span style="color:#E1E4E8">, (</span><span style="color:#79B8FF">3</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">3</span><span style="color:#E1E4E8">), </span><span style="color:#FFAB70">padding</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">&#39;same&#39;</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">activation</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">&#39;relu&#39;</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">input_shape</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">32</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">32</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">3</span><span style="color:#E1E4E8">)))</span></span>
<span class="line"><span style="color:#E1E4E8">model.add(BatchNormalization())</span></span>
<span class="line"><span style="color:#E1E4E8">model.add(MaxPool2D(</span><span style="color:#FFAB70">pool_size</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">2</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">2</span><span style="color:#E1E4E8">)))</span></span>
<span class="line"><span style="color:#E1E4E8">model.add(Dropout(</span><span style="color:#79B8FF">0.25</span><span style="color:#E1E4E8">))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D"># Second convolutional block</span></span>
<span class="line"><span style="color:#E1E4E8">model.add(Conv2D(</span><span style="color:#79B8FF">64</span><span style="color:#E1E4E8">, (</span><span style="color:#79B8FF">3</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">3</span><span style="color:#E1E4E8">), </span><span style="color:#FFAB70">padding</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">&#39;same&#39;</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">activation</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">&#39;relu&#39;</span><span style="color:#E1E4E8">))</span></span>
<span class="line"><span style="color:#E1E4E8">model.add(BatchNormalization())</span></span>
<span class="line"><span style="color:#E1E4E8">model.add(MaxPool2D(</span><span style="color:#FFAB70">pool_size</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">2</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">2</span><span style="color:#E1E4E8">)))</span></span>
<span class="line"><span style="color:#E1E4E8">model.add(Dropout(</span><span style="color:#79B8FF">0.25</span><span style="color:#E1E4E8">))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D"># Flatten and Dense layers for classification</span></span>
<span class="line"><span style="color:#E1E4E8">model.add(Flatten())</span></span>
<span class="line"><span style="color:#E1E4E8">model.add(Dense(</span><span style="color:#79B8FF">256</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">activation</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">&#39;relu&#39;</span><span style="color:#E1E4E8">))</span></span>
<span class="line"><span style="color:#E1E4E8">model.add(Dropout(</span><span style="color:#79B8FF">0.5</span><span style="color:#E1E4E8">))</span></span>
<span class="line"><span style="color:#E1E4E8">model.add(Dense(</span><span style="color:#79B8FF">10</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">activation</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">&#39;softmax&#39;</span><span style="color:#E1E4E8">))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">model.summary()</span></span></code></pre>
<h3 id="activation-function-and-regularization">Activation Function and Regularization</h3>
<p>The ReLU (Rectified Linear Unit) activation function is used in the convolutional layers, which helps the model learn more complex patterns without saturating the gradients during backpropagation. Batch normalization is used to stabilize training, while dropout is applied to prevent overfitting.</p>
<h3 id="loss-function-and-optimization">Loss Function and Optimization</h3>
<p>We use Categorical Cross-Entropy as the loss function for multi-class classification, and the Adam optimizer is used to minimize the loss.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0" data-language="python"><code><span class="line"><span style="color:#6A737D"># Compiling the model with Adam optimizer and Categorical Cross-Entropy loss function</span></span>
<span class="line"><span style="color:#E1E4E8">model.compile(</span><span style="color:#FFAB70">optimizer</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">&#39;adam&#39;</span><span style="color:#E1E4E8">, </span></span>
<span class="line"><span style="color:#FFAB70">              loss</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">&#39;categorical_crossentropy&#39;</span><span style="color:#E1E4E8">, </span></span>
<span class="line"><span style="color:#FFAB70">              metrics</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">[</span><span style="color:#9ECBFF">&#39;accuracy&#39;</span><span style="color:#E1E4E8">])</span></span></code></pre>
<h3 id="training-the-model">Training the Model</h3>
<p>The model is trained for up to 100 epochs with early stopping applied if the validation loss does not improve for 8 consecutive epochs.
The training process involves monitoring both the training and validation losses to ensure that the model doesn’t overfit.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0" data-language="py"><code><span class="line"><span style="color:#6A737D"># Early stopping callback to stop training if validation loss doesn&#39;t improve</span></span>
<span class="line"><span style="color:#E1E4E8">early_stopping </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> EarlyStopping(</span></span>
<span class="line"><span style="color:#FFAB70">    monitor</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">&#39;val_loss&#39;</span><span style="color:#E1E4E8">, </span></span>
<span class="line"><span style="color:#FFAB70">    patience</span><span style="color:#F97583">=</span><span style="color:#79B8FF">8</span><span style="color:#E1E4E8">,         </span></span>
<span class="line"><span style="color:#FFAB70">    restore_best_weights</span><span style="color:#F97583">=</span><span style="color:#79B8FF">True</span><span style="color:#E1E4E8"> </span></span>
<span class="line"><span style="color:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D"># Training the model</span></span>
<span class="line"><span style="color:#E1E4E8">history </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> model.fit(x_train, y_train,</span></span>
<span class="line"><span style="color:#FFAB70">    batch_size</span><span style="color:#F97583">=</span><span style="color:#79B8FF">32</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#FFAB70">    epochs</span><span style="color:#F97583">=</span><span style="color:#79B8FF">100</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#FFAB70">    validation_data</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">(x_val, y_val),</span></span>
<span class="line"><span style="color:#FFAB70">    shuffle</span><span style="color:#F97583">=</span><span style="color:#79B8FF">True</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#FFAB70">    callbacks</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">[early_stopping]</span></span>
<span class="line"><span style="color:#E1E4E8">)</span></span></code></pre>
<h3 id="training-and-validation-plots">Training and Validation Plots</h3>
<p>We plot the training and validation accuracy and loss to visualize the model’s performance during training.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0" data-language="py"><code><span class="line"><span style="color:#6A737D"># Plotting accuracy and loss curves for training and validation sets</span></span>
<span class="line"><span style="color:#E1E4E8">fig, axs </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> plt.subplots(</span><span style="color:#79B8FF">1</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">2</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">figsize</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">15</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">5</span><span style="color:#E1E4E8">)) </span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">axs[</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">].plot(history.history[</span><span style="color:#9ECBFF">&#39;accuracy&#39;</span><span style="color:#E1E4E8">]) </span></span>
<span class="line"><span style="color:#E1E4E8">axs[</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">].plot(history.history[</span><span style="color:#9ECBFF">&#39;val_accuracy&#39;</span><span style="color:#E1E4E8">]) </span></span>
<span class="line"><span style="color:#E1E4E8">axs[</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">].set_title(</span><span style="color:#9ECBFF">&#39;Accuracy&#39;</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">axs[</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">].set_ylabel(</span><span style="color:#9ECBFF">&#39;Accuracy&#39;</span><span style="color:#E1E4E8">) </span></span>
<span class="line"><span style="color:#E1E4E8">axs[</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">].set_xlabel(</span><span style="color:#9ECBFF">&#39;Epoch&#39;</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">axs[</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">].legend([</span><span style="color:#9ECBFF">&#39;train&#39;</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">&#39;validate&#39;</span><span style="color:#E1E4E8">], </span><span style="color:#FFAB70">loc</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">&#39;upper left&#39;</span><span style="color:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">axs[</span><span style="color:#79B8FF">1</span><span style="color:#E1E4E8">].plot(history.history[</span><span style="color:#9ECBFF">&#39;loss&#39;</span><span style="color:#E1E4E8">]) </span></span>
<span class="line"><span style="color:#E1E4E8">axs[</span><span style="color:#79B8FF">1</span><span style="color:#E1E4E8">].plot(history.history[</span><span style="color:#9ECBFF">&#39;val_loss&#39;</span><span style="color:#E1E4E8">]) </span></span>
<span class="line"><span style="color:#E1E4E8">axs[</span><span style="color:#79B8FF">1</span><span style="color:#E1E4E8">].set_title(</span><span style="color:#9ECBFF">&#39;Loss&#39;</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">axs[</span><span style="color:#79B8FF">1</span><span style="color:#E1E4E8">].set_ylabel(</span><span style="color:#9ECBFF">&#39;Loss&#39;</span><span style="color:#E1E4E8">) </span></span>
<span class="line"><span style="color:#E1E4E8">axs[</span><span style="color:#79B8FF">1</span><span style="color:#E1E4E8">].set_xlabel(</span><span style="color:#9ECBFF">&#39;Epoch&#39;</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">axs[</span><span style="color:#79B8FF">1</span><span style="color:#E1E4E8">].legend([</span><span style="color:#9ECBFF">&#39;train&#39;</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">&#39;validate&#39;</span><span style="color:#E1E4E8">], </span><span style="color:#FFAB70">loc</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">&#39;upper left&#39;</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">plt.show()</span></span></code></pre>
<h3 id="evaluation-and-results">Evaluation and Results</h3>
<p>After training, we evaluate the model on the test set and generate a classification report along with a confusion matrix to better understand the model’s performance.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0" data-language="py"><code><span class="line"><span style="color:#6A737D"># Evaluate the model on the test set</span></span>
<span class="line"><span style="color:#E1E4E8">scores </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> model.evaluate(x_test, y_test, </span><span style="color:#FFAB70">verbose</span><span style="color:#F97583">=</span><span style="color:#79B8FF">1</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#79B8FF">print</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">&#39;Test loss:&#39;</span><span style="color:#E1E4E8">, scores[</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">])</span></span>
<span class="line"><span style="color:#79B8FF">print</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">&#39;Test accuracy:&#39;</span><span style="color:#E1E4E8">, scores[</span><span style="color:#79B8FF">1</span><span style="color:#E1E4E8">])</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D"># Generating classification report</span></span>
<span class="line"><span style="color:#E1E4E8">predictions </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> np.argmax(model.predict(x_test), </span><span style="color:#FFAB70">axis</span><span style="color:#F97583">=-</span><span style="color:#79B8FF">1</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">y_test_multiclass </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> np.argmax(y_test, </span><span style="color:#FFAB70">axis</span><span style="color:#F97583">=-</span><span style="color:#79B8FF">1</span><span style="color:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#79B8FF">print</span><span style="color:#E1E4E8">(classification_report(y_test_multiclass, predictions))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D"># Confusion matrix</span></span>
<span class="line"><span style="color:#E1E4E8">confusion_matrix(y_test_multiclass, predictions)</span></span></code></pre>
<h3 id="visualizing-predictions">Visualizing Predictions</h3>
<p>We randomly select a test image, display it, and compare the real label with the predicted label.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0" data-language="py"><code><span class="line"><span style="color:#6A737D"># Visualizing a random test image and comparing real and predicted labels</span></span>
<span class="line"><span style="color:#F97583">from</span><span style="color:#E1E4E8"> random </span><span style="color:#F97583">import</span><span style="color:#E1E4E8"> randint</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">idx </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> randint(</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">len</span><span style="color:#E1E4E8">(x_test)</span><span style="color:#F97583">-</span><span style="color:#79B8FF">1</span><span style="color:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">test_image </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> x_test[idx]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">plt.imshow(test_image)</span></span>
<span class="line"><span style="color:#E1E4E8">plt.show()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#79B8FF">print</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">f</span><span style="color:#9ECBFF">&quot;Real Label: </span><span style="color:#79B8FF">{CLASS_NAMES</span><span style="color:#E1E4E8">[y_test_multiclass[idx]]</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF">&quot;</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#79B8FF">print</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">f</span><span style="color:#9ECBFF">&quot;Predicted Label: </span><span style="color:#79B8FF">{CLASS_NAMES</span><span style="color:#E1E4E8">[predictions[idx]]</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF">&quot;</span><span style="color:#E1E4E8">)</span></span></code></pre>
<h3 id="conclusion">Conclusion</h3>
<p>The model achieved an accuracy of 76% on the test set, demonstrating its capability to classify images correctly. The confusion matrix and classification report further help identify areas where the model can improve. This project highlights the effectiveness of CNNs for image classification tasks and the importance of model regularization and validation during training.</p></div></section> </main> <footer></footer> </body></html>